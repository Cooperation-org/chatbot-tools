# Setting Up the Slack Bot in a Slack Environment

## Requirements
To get started, ensure you have the following:
- **Slack Environment** 
- **Slack Token** 
- **Signing Secret**

---

## Steps

### 1. Create a New Slack App
1. Visit [Slack API Apps](https://api.slack.com/apps).
2. Click on **"Create New App"** and select **"From Scratch"**.
3. Provide a name for your app (e.g., `messageSaver`).
4. Click **"Create App"**.

---

### 2. Configure Bot Permissions
1. Navigate to the **Basic Information** tab:
   - Copy the **Signing Secret** and paste it into the `SLACK_SIGNING_SECRET` variable in your `.env` file.
2. Go to **OAuth & Permissions**:
   - Click **"Add OAuth Token"**.
   - Scroll down to **Scopes** and add the following Bot Token Scopes:
     - `team:read`
     - `channels:history`
     - `emoji:read`
     - `reactions:read`

---

### 3. Install the Bot to Slack
1. In the **OAuth & Permissions** section:
   - Under **OAuth Tokens**, click **"Install to Workspace"**.
   - Grant permissions by clicking **"Allow"**.
2. Copy the **Bot User OAuth Token** and paste it into the `SLACK_API_TOKEN` variable in your `.env` file.

---

### 4. Set Up a Public URL
You need a public URL to direct Slack's API to your bot:
1. Install `ngrok` or configure `nginx`.
2. Run `ngrok` to expose your local server:
   ```bash
   ngrok http <your_port>
   ```
3. Note the public URL generated by `ngrok` (e.g., `https://127.0.0.1:4040`).

---

### 5. Enable Events API
1. Navigate to **Event Subscriptions** in your Slack app settings.
2. Toggle **Enable Events** to **ON**.
3. In the **Request URL** field:
   - Paste your public URL from `ngrok` or `nginx` and append `/slack/events` (e.g., `https://127.0.0.1:4040/slack/events`).
4. Under **Subscribe to Bot Events**, add the following event types:
   - `emoji_changed`
   - `message.channels`
   - `reaction_added`
   - `reaction_removed`
   - `team_rename`
5. Click **"Save Changes"**.
6. Reinstall the app to apply the changes.

---

## Notes

### .env File Configuration
Your `.env` file should contain the following variables:
```dotenv
DB_USERNAME=<db_user>
DB_PASSWORD=<db_password>
DB_PORT=<db_port>
DB_NAME=<db_name>
SLACK_API_TOKEN=<your_slack_token_from_bot_installation>
SIGNING_SECRET=<your_slack_signing_secret>
HOST=<host>
HOST_PORT=<host_port>
DEBUG=<debug_bool>
```

Make sure to replace placeholders (`<...>`) with your actual values.
